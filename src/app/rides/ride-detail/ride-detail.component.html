<div *ngIf="ride$ | async as ride; else loading" class="ride-detail">
  <div class="ride-header">
    <h2>Ride Details</h2>
    <span class="created-at" *ngIf="ride.created_at">Created at: {{ ride.created_at | date: 'MMM dd, yyyy HH:mm' }}</span>
  </div>
  
  <div class="ride-info">
    <div class="route-info">
      <h3>Route</h3>
      <p>
        <strong>From:</strong> {{ ride.departure_location }}
      </p>
      <p>
        <strong>To:</strong> {{ ride.destination_location }}
      </p>
    </div>
    
    <div class="time-info">
      <h3>Schedule</h3>
      <p>
        <strong>Date:</strong> {{ ride.departure_time | date: 'EEEE, MMM dd, yyyy' }}
      </p>
      <p>
        <strong>Departure:</strong> {{ ride.departure_time | date: 'HH:mm' }}
      </p>
    </div>
    
    <div class="driver-info">
      <h3>Driver Information</h3>
      <p>
        <strong>Name:</strong> {{ getDriverName(ride) }}
      </p>
      <p *ngIf="getDriverMobile(ride)">
        <strong>Mobile:</strong> {{ getDriverMobile(ride) }}
      </p>
      <p *ngIf="getDriverEmail(ride)">
        <strong>Email:</strong> {{ getDriverEmail(ride) }}
      </p>
    </div>
    
    <div class="seats-info">
      <h3>Availability</h3>
      <p>
        <strong>Available Seats:</strong> {{ ride.seats_available }}
      </p>
    </div>
  </div>
  
  <div class="actions">
    <!-- Request Button: Nur für fremde Fahrten -->
    <button 
      *ngIf="!isOwnRide"
      class="request-button" 
      (click)="sendRequest()"
      [disabled]="isRequesting">
      {{ isRequesting ? 'Sending request...' : 'Request Ride' }}
    </button>
    
    <!-- Delete Button: Nur für meine Fahrten -->
    <button 
      *ngIf="isOwnRide"
      class="delete-button" 
      (click)="deleteRide()"
      [disabled]="isDeleting">
      {{ isDeleting ? 'Deleting...' : 'Delete Ride' }}
    </button>
    
    <a routerLink="/rides" class="back-link">Back to Rides</a>
  </div>
  
  <div *ngIf="requestSuccess" class="success-message">
    Your request has been successfully sent!
  </div>
  
  <div *ngIf="requestError" class="error-message">
    {{ requestError }}
  </div>

  <div *ngIf="deleteSuccess" class="success-message">
    Die Fahrt wurde erfolgreich gelöscht! Weitergeleitet...
  </div>
  
  <div *ngIf="deleteError" class="error-message">
    {{ deleteError }}
  </div>
</div>

<ng-template #loading>
  <div class="loading">
    <p>Loading ride details...</p>
  </div>
</ng-template>